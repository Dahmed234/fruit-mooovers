[gd_scene load_steps=37 format=3 uid="uid://ca8kwae33nfxd"]

[ext_resource type="Script" uid="uid://cnx47c3mqhr1r" path="res://scenes/player/player.gd" id="1_glu7e"]
[ext_resource type="Script" uid="uid://35oyduh6tuxo" path="res://scenes/player/throwController.gd" id="2_p3xyx"]
[ext_resource type="Texture2D" uid="uid://c46uv3a4y1ogs" path="res://assets/kenney_1-bit-pack/Tilesheet/colored-transparent.png" id="2_wuy1y"]
[ext_resource type="PackedScene" uid="uid://cfp1kmchhvpv" path="res://scenes/ui/health_bar.tscn" id="3_pn6s4"]
[ext_resource type="Script" uid="uid://vo65g72yyrot" path="res://scenes/player/whistle.gd" id="4_p3xyx"]
[ext_resource type="Texture2D" uid="uid://c6x4ey8dxp7dc" path="res://assets/lights/Light texture transparent.png" id="5_wuy1y"]
[ext_resource type="Script" uid="uid://cwb0gdf6mdhuy" path="res://scenes/ui/throw_marker.gd" id="6_1nynx"]
[ext_resource type="Script" uid="uid://cebac1r02ercw" path="res://scenes/player/whistle_outline.gd" id="7_pn6s4"]
[ext_resource type="Script" uid="uid://bvahw0aufjgr" path="res://scenes/player/animation_tree.gd" id="8_v42im"]
[ext_resource type="AudioStream" uid="uid://bwdf26r1l7y1k" path="res://sounds/sound effects/footstep04.ogg" id="10_7oing"]

[sub_resource type="CircleShape2D" id="CircleShape2D_p3xyx"]
radius = 6.8761363

[sub_resource type="CircleShape2D" id="CircleShape2D_glu7e"]
radius = 221.90314

[sub_resource type="RectangleShape2D" id="RectangleShape2D_glu7e"]
size = Vector2(65.333336, 40.666668)

[sub_resource type="CircleShape2D" id="CircleShape2D_wuy1y"]
radius = 5.0

[sub_resource type="Animation" id="Animation_7oing"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CollisionShape2D:shape:radius")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [5.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Line2D:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 0)]
}

[sub_resource type="Animation" id="Animation_pn6s4"]
resource_name = "grow_whistle"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("CollisionShape2D:shape:radius")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.8),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [25.0, 193.12]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Line2D:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0.7482, 0.86, 0.8357767, 0.8)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_7oing"]
_data = {
&"RESET": SubResource("Animation_7oing"),
&"grow_whistle": SubResource("Animation_pn6s4")
}

[sub_resource type="Gradient" id="Gradient_pn6s4"]
interpolation_mode = 1
offsets = PackedFloat32Array(0, 0.52522254)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_7oing"]
gradient = SubResource("Gradient_pn6s4")
width = 4

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_7oing"]
animation = &"RESET"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_5stf6"]
animation = &"grow_whistle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_20koh"]
xfade_time = 0.07
advance_mode = 2
advance_expression = "isWhistling"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_ov1oi"]
xfade_time = 0.1
priority = 2
advance_mode = 2
advance_expression = "!isWhistling"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_pn6s4"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_pn6s4"]
states/RESET/node = SubResource("AnimationNodeAnimation_7oing")
states/RESET/position = Vector2(344, 77.2)
states/Start/position = Vector2(185.6, 85.6)
states/grow_whistle/node = SubResource("AnimationNodeAnimation_5stf6")
states/grow_whistle/position = Vector2(546.4, 110)
transitions = ["RESET", "grow_whistle", SubResource("AnimationNodeStateMachineTransition_20koh"), "grow_whistle", "RESET", SubResource("AnimationNodeStateMachineTransition_ov1oi"), "Start", "RESET", SubResource("AnimationNodeStateMachineTransition_pn6s4")]

[sub_resource type="NavigationPolygon" id="NavigationPolygon_glu7e"]
vertices = PackedVector2Array(-2.9375, -24.5625, -6.546875, -34.8125, 20.117188, -32.351563, 15.671875, -24.34375)
polygons = Array[PackedInt32Array]([PackedInt32Array(0, 1, 2), PackedInt32Array(0, 2, 3)])
outlines = Array[PackedVector2Array]([PackedVector2Array(-21.162271, -46.204296, 36.328568, -40.913727, 21.514977, -14.284536, -10.052078, -14.63724)])
sample_partition_type = 1

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_v42im"]
animation = &"RESET"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_pn6s4"]
animation = &"new_animation"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_7oing"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "is_moving == true"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_5stf6"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_180ig"]
xfade_time = 0.2
advance_mode = 2
advance_expression = "is_moving == false"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_20koh"]
states/RESET/node = SubResource("AnimationNodeAnimation_v42im")
states/RESET/position = Vector2(336, 92.4)
states/Start/position = Vector2(199.2, 100)
states/new_animation/node = SubResource("AnimationNodeAnimation_pn6s4")
states/new_animation/position = Vector2(520, 72.399994)
transitions = ["RESET", "new_animation", SubResource("AnimationNodeStateMachineTransition_7oing"), "Start", "RESET", SubResource("AnimationNodeStateMachineTransition_5stf6"), "new_animation", "RESET", SubResource("AnimationNodeStateMachineTransition_180ig")]

[sub_resource type="Animation" id="Animation_v42im"]
loop_mode = 1
tracks/0/type = "bezier"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:position:x")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"handle_modes": PackedInt32Array(2),
"points": PackedFloat32Array(0, -0.13333501, 0, 0.13333501, 0),
"times": PackedFloat32Array(0)
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:position:y")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(2),
"points": PackedFloat32Array(0, -0.13333501, 0, 0.13333501, 0),
"times": PackedFloat32Array(0)
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:scale")
tracks/2/interp = 2
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(4, 4)]
}

[sub_resource type="Animation" id="Animation_5stf6"]
resource_name = "idle"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:scale")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.94),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(4, 4), Vector2(4, 4)]
}

[sub_resource type="Animation" id="Animation_npwbq"]
resource_name = "new_animation"
length = 0.5333367
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite2D:flip_h")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.26666668, 0.53333336),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [false, true, false]
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite2D:position:x")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(2, 2, 2, 0, 0),
"points": PackedFloat32Array(-10.551319, 0, 0, 0.022510134, 3.1666667, -0.66420174, -0.034998313, -9.766015, 0.03333333, 9.301415, 9.447996, -0.03303653, -0.16043282, 0, 0, -0.66420174, -0.03333333, 9.436548, 0.03333333, -10.697897, -10.551319, 0, 0, 0, 4.8647013),
"times": PackedFloat32Array(0, 0.13333334, 0.26667002, 0.4, 0.53333336)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite2D:position:y")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(2, 2, 2, 0, 0),
"points": PackedFloat32Array(0, 0, 0, 0.022510134, -5, -14.740365, -0.06839413, -0.27026176, 0.06495621, 0.2566767, -0.21383464, -0.02193487, -5, 0, 0, -14.740365, -0.06839413, -0.27026176, 0.06495621, 0.2566767, 0, 0, 0, 0.022510134, -5),
"times": PackedFloat32Array(0, 0.1350608, 0.26666668, 0.4, 0.53333336)
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_pn6s4"]
_data = {
&"RESET": SubResource("Animation_v42im"),
&"idle": SubResource("Animation_5stf6"),
&"new_animation": SubResource("Animation_npwbq")
}

[node name="Player" type="CharacterBody2D" groups=["Player"]]
texture_filter = 1
collision_layer = 4
script = ExtResource("1_glu7e")
speed = 300.0
throwDistance = 500.0
health = 1000.0
footstep_interval = 0.3
footstep_max_pitch = 1.2
footstep_min_pitch = 0.8

[node name="physics Collision2" type="CollisionShape2D" parent="."]
position = Vector2(-0.5, 0.5)
scale = Vector2(4, 4)
shape = SubResource("CircleShape2D_p3xyx")

[node name="Sprite2D" type="Sprite2D" parent="."]
scale = Vector2(4, 4)
texture = ExtResource("2_wuy1y")
region_enabled = true
region_rect = Rect2(407, 16, 18, 17)

[node name="Health" parent="Sprite2D" instance=ExtResource("3_pn6s4")]

[node name="Radii" type="CharacterBody2D" parent="."]
collision_layer = 0

[node name="Throw Radius" type="Area2D" parent="Radii"]
collision_layer = 0
collision_mask = 4
script = ExtResource("2_p3xyx")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Radii/Throw Radius"]
position = Vector2(0, -16)
shape = SubResource("CircleShape2D_glu7e")

[node name="visible pikmin" type="Area2D" parent="Radii"]
position = Vector2(-136, -149)
scale = Vector2(4.62638, 3.489611)
collision_layer = 8
collision_mask = 4

[node name="CollisionShape2D" type="CollisionShape2D" parent="Radii/visible pikmin"]
position = Vector2(28.74818, 8.596945)
shape = SubResource("RectangleShape2D_glu7e")

[node name="whistleBox" type="Area2D" parent="Radii"]
collision_layer = 0
collision_mask = 4
script = ExtResource("4_p3xyx")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Radii/whistleBox"]
shape = SubResource("CircleShape2D_wuy1y")

[node name="Sprite2D2" type="Sprite2D" parent="Radii/whistleBox/CollisionShape2D"]
modulate = Color(1, 1, 1, 0.39215687)
position = Vector2(-3.8146973e-06, -2.861023e-06)
scale = Vector2(1.37, 1.37)
texture = ExtResource("5_wuy1y")

[node name="whistleAnim" type="AnimationPlayer" parent="Radii/whistleBox"]
libraries = {
&"": SubResource("AnimationLibrary_7oing")
}

[node name="Line2D" type="Line2D" parent="Radii/whistleBox"]
modulate = Color(1, 1, 1, 0)
texture_repeat = 2
points = PackedVector2Array(0, 0, 126.945, 0)
closed = true
width = 5.0
texture = SubResource("GradientTexture1D_7oing")
texture_mode = 1
antialiased = true
script = ExtResource("7_pn6s4")
shape = SubResource("CircleShape2D_wuy1y")
resolution = 1024

[node name="AnimationTree" type="AnimationTree" parent="Radii/whistleBox"]
tree_root = SubResource("AnimationNodeStateMachine_pn6s4")
advance_expression_base_node = NodePath("..")
anim_player = NodePath("../whistleAnim")

[node name="Enemy detection box" type="Area2D" parent="."]
collision_layer = 128
collision_mask = 128

[node name="CollisionShape2D" type="CollisionShape2D" parent="Enemy detection box"]
position = Vector2(-0.5, 0.5)
scale = Vector2(4, 4)
shape = SubResource("CircleShape2D_p3xyx")

[node name="NavigationRegion2D" type="NavigationRegion2D" parent="."]
position = Vector2(-42.999996, 108)
scale = Vector2(5.6704693, 5.6704693)
navigation_polygon = SubResource("NavigationPolygon_glu7e")
navigation_layers = 2

[node name="Sprite throw marker" type="Sprite2D" parent="."]
z_index = 2
texture_filter = 1
scale = Vector2(2, 2)
texture = ExtResource("2_wuy1y")
region_enabled = true
region_rect = Rect2(646, 339, 16, 17)
script = ExtResource("6_1nynx")

[node name="AnimationTree" type="AnimationTree" parent="."]
tree_root = SubResource("AnimationNodeStateMachine_20koh")
anim_player = NodePath("../AnimationPlayer")
script = ExtResource("8_v42im")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_pn6s4")
}

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource("10_7oing")
